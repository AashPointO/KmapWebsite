<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="style.css">
		<script src="script.js">
		</script>
	</head>
	<body>
		<div id="genBody">
			<div>
				<h1> K-Map Generator with Multiple Outputs </h1>
				<div>
					<p id="input-text-fields" class="standard-border"> 
					numBits:  <input type="number" id="nBits"
						       value=2 min=2 max=4
						       onfocusout="ensureValidBounds('nBits', 2, 4)">
					<br>
					<br>
					numOutputs:  <input type="number" id="nOutputs"
							 value=1 min=1 max=8 
							 onfocusout="ensureValidBounds('nOutputs', 1, 8)">
					</p>
				</div>

				<table id="truth-table" class="standard-border">
					<!-- Table is modified entirely onto the truth-table -->
				</table>

				<br>
				<br>
				<br>
				<hr>
				<br>

				<div class="flex-container" id="k-map-container" data-numtables="0" >
				</div>
			</div>
		</div>
		<script>
			let tableRef = document.getElementById("truth-table");
			let kMapContainerRef = document.getElementById("k-map-container");
			let desiredNumBits = parseInt(document.getElementById("nBits").value);
			let desiredNumOutputs = parseInt(document.getElementById("nOutputs").value);

			initTruthTable(tableRef, kMapContainerRef, desiredNumBits, desiredNumOutputs);
			
			document.getElementById("nBits").addEventListener("focusout", textFieldFocusOut);
			document.getElementById("nOutputs").addEventListener("focusout", textFieldFocusOut);

			function initTruthTable(tableRef, kMapContainerRef, desiredNumBits, desiredNumOutputs) {
				let numRowsNeeded = Math.pow(2, desiredNumBits) + 1; // + 1 being for the header

				addRows(tableRef, numRowsNeeded);
				addIndexCols(tableRef, parseInt(tableRef.rows.length));
				addHeaderCols(tableRef, desiredNumBits, desiredNumOutputs);

				addBitCols(tableRef, desiredNumBits);
				addOutputCols(tableRef, desiredNumBits, desiredNumOutputs);

				addBinaryValues(tableRef);
				addOutputTextFields(tableRef);

				addAllKmaps(kMapContainerRef, desiredNumBits, desiredNumOutputs);
			}

		</script>
	</body>
</html>
